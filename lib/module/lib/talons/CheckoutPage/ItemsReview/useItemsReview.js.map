{"version":3,"sources":["useItemsReview.js"],"names":["useEffect","useState","useCallback","useLazyQuery","useCartContext","useItemsReview","props","showAllItems","setShowAllItems","queries","getItemsInCart","cartId","fetchItemsInCart","data","queryData","error","loading","fetchPolicy","setShowAllItemsFlag","variables","cart","items","length","totalQuantity","total_quantity","isLoading","hasErrors"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,WAA9B,QAAiD,OAAjD;AACA,SAASC,YAAT,QAA6B,gBAA7B;AAEA,SAASC,cAAT,QAA+B,uBAA/B;AAEA,OAAO,MAAMC,cAAc,GAAGC,KAAK,IAAI;AACnC,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCP,QAAQ,CAAC,KAAD,CAAhD;AAEA,QAAM;AACFQ,IAAAA,OAAO,EAAE;AAAEC,MAAAA;AAAF;AADP,MAEFJ,KAFJ;AAIA,QAAM,CAAC;AAAEK,IAAAA;AAAF,GAAD,IAAeP,cAAc,EAAnC;AAEA,QAAM,CACFQ,gBADE,EAEF;AAAEC,IAAAA,IAAI,EAAEC,SAAR;AAAmBC,IAAAA,KAAnB;AAA0BC,IAAAA;AAA1B,GAFE,IAGFb,YAAY,CAACO,cAAD,EAAiB;AAC7BO,IAAAA,WAAW,EAAE;AADgB,GAAjB,CAHhB,CATmC,CAgBnC;;AACA,QAAMJ,IAAI,GAAGP,KAAK,CAACO,IAAN,IAAcC,SAA3B;AAEA,QAAMI,mBAAmB,GAAGhB,WAAW,CAAC,MAAMM,eAAe,CAAC,IAAD,CAAtB,EAA8B,CACjEA,eADiE,CAA9B,CAAvC;AAIAR,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAIW,MAAM,IAAI,CAACL,KAAK,CAACO,IAArB,EAA2B;AACvBD,MAAAA,gBAAgB,CAAC;AACbO,QAAAA,SAAS,EAAE;AACPR,UAAAA;AADO;AADE,OAAD,CAAhB;AAKH;AACJ,GARQ,EAQN,CAACA,MAAD,EAASC,gBAAT,EAA2BN,KAAK,CAACO,IAAjC,CARM,CAAT;AAUAb,EAAAA,SAAS,CAAC,MAAM;AACZ;;;;AAIA,QAAIa,IAAI,IAAIA,IAAI,CAACO,IAAb,IAAqBP,IAAI,CAACO,IAAL,CAAUC,KAAV,CAAgBC,MAAhB,IAA0B,CAAnD,EAAsD;AAClDd,MAAAA,eAAe,CAAC,IAAD,CAAf;AACH;AACJ,GARQ,EAQN,CAACK,IAAD,CARM,CAAT;AAUA,QAAMQ,KAAK,GAAGR,IAAI,GAAGA,IAAI,CAACO,IAAL,CAAUC,KAAb,GAAqB,EAAvC;AAEA,QAAME,aAAa,GAAGV,IAAI,GAAG,CAACA,IAAI,CAACO,IAAL,CAAUI,cAAd,GAA+B,CAAzD;AAEA,SAAO;AACHC,IAAAA,SAAS,EAAE,CAAC,CAACT,OADV;AAEHK,IAAAA,KAFG;AAGHK,IAAAA,SAAS,EAAE,CAAC,CAACX,KAHV;AAIHQ,IAAAA,aAJG;AAKHhB,IAAAA,YALG;AAMHC,IAAAA,eAAe,EAAEU;AANd,GAAP;AAQH,CAvDM","sourcesContent":["import { useEffect, useState, useCallback } from 'react';\nimport { useLazyQuery } from '@apollo/client';\n\nimport { useCartContext } from '../../../context/cart';\n\nexport const useItemsReview = props => {\n    const [showAllItems, setShowAllItems] = useState(false);\n\n    const {\n        queries: { getItemsInCart }\n    } = props;\n\n    const [{ cartId }] = useCartContext();\n\n    const [\n        fetchItemsInCart,\n        { data: queryData, error, loading }\n    ] = useLazyQuery(getItemsInCart, {\n        fetchPolicy: 'cache-and-network'\n    });\n\n    // If static data was provided, use that instead of query data.\n    const data = props.data || queryData;\n\n    const setShowAllItemsFlag = useCallback(() => setShowAllItems(true), [\n        setShowAllItems\n    ]);\n\n    useEffect(() => {\n        if (cartId && !props.data) {\n            fetchItemsInCart({\n                variables: {\n                    cartId\n                }\n            });\n        }\n    }, [cartId, fetchItemsInCart, props.data]);\n\n    useEffect(() => {\n        /**\n         * If there are 2 or less than 2 items in cart\n         * set show all items to `true`.\n         */\n        if (data && data.cart && data.cart.items.length <= 2) {\n            setShowAllItems(true);\n        }\n    }, [data]);\n\n    const items = data ? data.cart.items : [];\n\n    const totalQuantity = data ? +data.cart.total_quantity : 0;\n\n    return {\n        isLoading: !!loading,\n        items,\n        hasErrors: !!error,\n        totalQuantity,\n        showAllItems,\n        setShowAllItems: setShowAllItemsFlag\n    };\n};\n"]}