{"version":3,"sources":["useNavigation.js"],"names":["useCallback","useEffect","useState","useAppContext","useCatalogContext","useUserContext","useAwaitQuery","ancestors","CREATE_ACCOUNT","FORGOT_PASSWORD","MY_ACCOUNT","SIGN_IN","MENU","useNavigation","props","customerQuery","appState","closeDrawer","catalogState","actions","catalogActions","getUserDetails","fetchUserDetails","drawer","isOpen","categories","rootCategoryId","view","setView","categoryId","setCategoryId","category","isTopLevel","hasModal","handleBack","parent","parentId","handleClose","showCreateAccount","showForgotPassword","showMainMenu","showMyAccount","showSignIn"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport { useAppContext } from '@magento/peregrine/lib/context/app';\nimport { useCatalogContext } from '@magento/peregrine/lib/context/catalog';\nimport { useUserContext } from '@magento/peregrine/lib/context/user';\nimport { useAwaitQuery } from '@magento/peregrine/lib/hooks/useAwaitQuery';\n\nconst ancestors = {\n    CREATE_ACCOUNT: 'SIGN_IN',\n    FORGOT_PASSWORD: 'SIGN_IN',\n    MY_ACCOUNT: 'MENU',\n    SIGN_IN: 'MENU',\n    MENU: null\n};\n\nexport const useNavigation = props => {\n    const { customerQuery } = props;\n    // retrieve app state from context\n    const [appState, { closeDrawer }] = useAppContext();\n    const [catalogState, { actions: catalogActions }] = useCatalogContext();\n    const [, { getUserDetails }] = useUserContext();\n    const fetchUserDetails = useAwaitQuery(customerQuery);\n\n    // request data from server\n    useEffect(() => {\n        getUserDetails({ fetchUserDetails });\n    }, [fetchUserDetails, getUserDetails]);\n\n    // extract relevant data from app state\n    const { drawer } = appState;\n    const isOpen = drawer === 'nav';\n    const { categories, rootCategoryId } = catalogState;\n\n    // get local state\n    const [view, setView] = useState('MENU');\n    const [categoryId, setCategoryId] = useState(rootCategoryId);\n\n    // define local variables\n    const category = categories[categoryId];\n    const isTopLevel = categoryId === rootCategoryId;\n    const hasModal = view !== 'MENU';\n\n    // define handlers\n    const handleBack = useCallback(() => {\n        const parent = ancestors[view];\n\n        if (parent) {\n            setView(parent);\n        } else if (category && !isTopLevel) {\n            setCategoryId(category.parentId);\n        } else {\n            closeDrawer();\n        }\n    }, [category, closeDrawer, isTopLevel, view]);\n\n    const handleClose = useCallback(() => {\n        closeDrawer();\n    }, [closeDrawer]);\n\n    // create callbacks for local state\n    const showCreateAccount = useCallback(() => {\n        setView('CREATE_ACCOUNT');\n    }, [setView]);\n    const showForgotPassword = useCallback(() => {\n        setView('FORGOT_PASSWORD');\n    }, [setView]);\n    const showMainMenu = useCallback(() => {\n        setView('MENU');\n    }, [setView]);\n    const showMyAccount = useCallback(() => {\n        setView('MY_ACCOUNT');\n    }, [setView]);\n    const showSignIn = useCallback(() => {\n        setView('SIGN_IN');\n    }, [setView]);\n\n    return {\n        catalogActions,\n        categories,\n        categoryId,\n        handleBack,\n        handleClose,\n        hasModal,\n        isOpen,\n        isTopLevel,\n        setCategoryId,\n        showCreateAccount,\n        showForgotPassword,\n        showMainMenu,\n        showMyAccount,\n        showSignIn,\n        view\n    };\n};\n"]}