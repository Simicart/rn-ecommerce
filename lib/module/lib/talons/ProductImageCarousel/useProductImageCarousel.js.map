{"version":3,"sources":["useProductImageCarousel.js"],"names":["useCallback","useEffect","useCarousel","sendMessageToSW","VALID_SERVICE_WORKER_ENVIRONMENT","PREFETCH_IMAGES","generateUrlFromContainerWidth","useProductImageCarousel","props","images","type","imageWidth","carouselState","carouselApi","activeItemIndex","sortedImages","handlePrevious","handleNext","setActiveItemIndex","handleThumbnailClick","index","urls","map","file","URL","location","origin","href","catch","err","console","error","currentImage","altText","label"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,SAAtB,QAAuC,OAAvC;AAEA,SAASC,WAAT,QAA4B,oBAA5B;AAEA,SACIC,eADJ,EAEIC,gCAFJ,QAGO,oCAHP;AAIA,SAASC,eAAT,QAAgC,gDAAhC;AACA,SAASC,6BAAT,QAA8C,mCAA9C;AAEA,OAAO,MAAMC,uBAAuB,GAAGC,KAAK,IAAI;AAC5C,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,IAAV;AAAgBC,IAAAA;AAAhB,MAA+BH,KAArC;AACA,QAAM,CAACI,aAAD,EAAgBC,WAAhB,IAA+BX,WAAW,CAACO,MAAD,CAAhD;AACA,QAAM;AAAEK,IAAAA,eAAF;AAAmBC,IAAAA;AAAnB,MAAoCH,aAA1C;AACA,QAAM;AAAEI,IAAAA,cAAF;AAAkBC,IAAAA,UAAlB;AAA8BC,IAAAA;AAA9B,MAAqDL,WAA3D;AAEA,QAAMM,oBAAoB,GAAGnB,WAAW,CACpCoB,KAAK,IAAI;AACLF,IAAAA,kBAAkB,CAACE,KAAD,CAAlB;AACH,GAHmC,EAIpC,CAACF,kBAAD,CAJoC,CAAxC,CAN4C,CAa5C;;AACAjB,EAAAA,SAAS,CAAC,MAAM;AACZiB,IAAAA,kBAAkB,CAAC,CAAD,CAAlB;AACH,GAFQ,EAEN,CAACT,MAAD,EAASS,kBAAT,CAFM,CAAT;AAIAjB,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAIG,gCAAJ,EAAsC;AAClC,YAAMiB,IAAI,GAAGZ,MAAM,CAACa,GAAP,CACT,CAAC;AAAEC,QAAAA;AAAF,OAAD,KACI,IAAIC,GAAJ,CACIlB,6BAA6B,CAACiB,IAAD,EAAOZ,UAAP,EAAmBD,IAAnB,CADjC,EAEIe,QAAQ,CAACC,MAFb,EAGEC,IALG,CAAb;AAOAxB,MAAAA,eAAe,CAACE,eAAD,EAAkB;AAC7BgB,QAAAA;AAD6B,OAAlB,CAAf,CAEGO,KAFH,CAESC,GAAG,IAAI;AACZC,QAAAA,OAAO,CAACC,KAAR,CACI,8CADJ,EAEIF,GAFJ;AAIH,OAPD;AAQH;AACJ,GAlBQ,EAkBN,CAACpB,MAAD,EAASE,UAAT,EAAqBD,IAArB,CAlBM,CAAT;AAoBA,QAAMsB,YAAY,GAAGjB,YAAY,CAACD,eAAD,CAAZ,IAAiC,EAAtD;AACA,QAAMmB,OAAO,GAAGD,YAAY,CAACE,KAAb,IAAsB,eAAtC;AAEA,SAAO;AACHF,IAAAA,YADG;AAEHlB,IAAAA,eAFG;AAGHmB,IAAAA,OAHG;AAIHhB,IAAAA,UAJG;AAKHD,IAAAA,cALG;AAMHG,IAAAA,oBANG;AAOHJ,IAAAA;AAPG,GAAP;AASH,CAlDM","sourcesContent":["import { useCallback, useEffect } from 'react';\n\nimport { useCarousel } from '@magento/peregrine';\n\nimport {\n    sendMessageToSW,\n    VALID_SERVICE_WORKER_ENVIRONMENT\n} from '@magento/venia-ui/lib/util/swUtils';\nimport { PREFETCH_IMAGES } from '@magento/venia-ui/lib/constants/swMessageTypes';\nimport { generateUrlFromContainerWidth } from '@magento/venia-ui/lib/util/images';\n\nexport const useProductImageCarousel = props => {\n    const { images, type, imageWidth } = props;\n    const [carouselState, carouselApi] = useCarousel(images);\n    const { activeItemIndex, sortedImages } = carouselState;\n    const { handlePrevious, handleNext, setActiveItemIndex } = carouselApi;\n\n    const handleThumbnailClick = useCallback(\n        index => {\n            setActiveItemIndex(index);\n        },\n        [setActiveItemIndex]\n    );\n\n    // Whenever the incoming images changes reset the active item to the first.\n    useEffect(() => {\n        setActiveItemIndex(0);\n    }, [images, setActiveItemIndex]);\n\n    useEffect(() => {\n        if (VALID_SERVICE_WORKER_ENVIRONMENT) {\n            const urls = images.map(\n                ({ file }) =>\n                    new URL(\n                        generateUrlFromContainerWidth(file, imageWidth, type),\n                        location.origin\n                    ).href\n            );\n            sendMessageToSW(PREFETCH_IMAGES, {\n                urls\n            }).catch(err => {\n                console.error(\n                    'Unable to send PREFETCH_IMAGES message to SW',\n                    err\n                );\n            });\n        }\n    }, [images, imageWidth, type]);\n\n    const currentImage = sortedImages[activeItemIndex] || {};\n    const altText = currentImage.label || 'image-product';\n\n    return {\n        currentImage,\n        activeItemIndex,\n        altText,\n        handleNext,\n        handlePrevious,\n        handleThumbnailClick,\n        sortedImages\n    };\n};\n"]}