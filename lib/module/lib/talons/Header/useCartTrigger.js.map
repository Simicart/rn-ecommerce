{"version":3,"sources":["useCartTrigger.js"],"names":["useCallback","useQuery","useHistory","useCartContext","useDropdown","DENIED_MINI_CART_ROUTES","useCartTrigger","props","queries","getItemCountQuery","cartId","elementRef","miniCartRef","expanded","miniCartIsOpen","setExpanded","setMiniCartIsOpen","history","data","fetchPolicy","nextFetchPolicy","variables","skip","itemCount","cart","total_quantity","hideCartTrigger","includes","location","pathname","handleTriggerClick","handleLinkClick","push"],"mappings":"AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,SAASC,cAAT,QAA+B,qCAA/B;AACA,SAASC,WAAT,QAA4B,0CAA5B;AAEA;;;;AAGA,MAAMC,uBAAuB,GAAG,CAAC,WAAD,CAAhC;AAEA;;;;;;;;;;;;;;;AAcA,OAAO,MAAMC,cAAc,GAAGC,KAAK,IAAI;AACnC,QAAM;AACFC,IAAAA,OAAO,EAAE;AAAEC,MAAAA;AAAF;AADP,MAEFF,KAFJ;AAIA,QAAM,CAAC;AAAEG,IAAAA;AAAF,GAAD,IAAeP,cAAc,EAAnC;AACA,QAAM;AACFQ,IAAAA,UAAU,EAAEC,WADV;AAEFC,IAAAA,QAAQ,EAAEC,cAFR;AAGFC,IAAAA,WAAW,EAAEC;AAHX,MAIFZ,WAAW,EAJf;AAKA,QAAMa,OAAO,GAAGf,UAAU,EAA1B;AAEA,QAAM;AAAEgB,IAAAA;AAAF,MAAWjB,QAAQ,CAACQ,iBAAD,EAAoB;AACzCU,IAAAA,WAAW,EAAE,mBAD4B;AAEzCC,IAAAA,eAAe,EAAE,aAFwB;AAGzCC,IAAAA,SAAS,EAAE;AACPX,MAAAA;AADO,KAH8B;AAMzCY,IAAAA,IAAI,EAAE,CAACZ;AANkC,GAApB,CAAzB;AAQA,QAAMa,SAAS,GAAGL,IAAI,GAAGA,IAAI,CAACM,IAAL,CAAUC,cAAb,GAA8B,CAApD;AACA,QAAMC,eAAe,GAAGrB,uBAAuB,CAACsB,QAAxB,CACpBV,OAAO,CAACW,QAAR,CAAiBC,QADG,CAAxB;AAIA,QAAMC,kBAAkB,GAAG9B,WAAW,CAAC,MAAM;AACzC;AACAgB,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACH,GAHqC,EAGnC,CAACA,iBAAD,CAHmC,CAAtC;AAKA,QAAMe,eAAe,GAAG/B,WAAW,CAAC,MAAM;AACtC;AACAiB,IAAAA,OAAO,CAACe,IAAR,CAAa,OAAb;AACH,GAHkC,EAGhC,CAACf,OAAD,CAHgC,CAAnC;AAKA,SAAO;AACHc,IAAAA,eADG;AAEHD,IAAAA,kBAFG;AAGHP,IAAAA,SAHG;AAIHT,IAAAA,cAJG;AAKHF,IAAAA,WALG;AAMHc,IAAAA,eANG;AAOHV,IAAAA;AAPG,GAAP;AASH,CA7CM","sourcesContent":["import { useCallback } from 'react';\nimport { useQuery } from '@apollo/client';\nimport { useHistory } from 'react-router-dom';\n\nimport { useCartContext } from '@magento/peregrine/lib/context/cart';\nimport { useDropdown } from '@magento/peregrine/lib/hooks/useDropdown';\n\n/**\n * Routes to hide the mini cart on.\n */\nconst DENIED_MINI_CART_ROUTES = ['/checkout'];\n\n/**\n *\n * @param {DocumentNode} props.queries.getItemCountQuery query to get the total cart items count\n *\n * @returns {\n *      itemCount: Number,\n *      miniCartIsOpen: Boolean,\n *      handleLinkClick: Function,\n *      handleTriggerClick: Function,\n *      miniCartRef: Function,\n *      hideCartTrigger: Function,\n *      setMiniCartIsOpen: Function\n *  }\n */\nexport const useCartTrigger = props => {\n    const {\n        queries: { getItemCountQuery }\n    } = props;\n\n    const [{ cartId }] = useCartContext();\n    const {\n        elementRef: miniCartRef,\n        expanded: miniCartIsOpen,\n        setExpanded: setMiniCartIsOpen\n    } = useDropdown();\n    const history = useHistory();\n\n    const { data } = useQuery(getItemCountQuery, {\n        fetchPolicy: 'cache-and-network',\n        nextFetchPolicy: 'cache-first',\n        variables: {\n            cartId\n        },\n        skip: !cartId\n    });\n    const itemCount = data ? data.cart.total_quantity : 0;\n    const hideCartTrigger = DENIED_MINI_CART_ROUTES.includes(\n        history.location.pathname\n    );\n\n    const handleTriggerClick = useCallback(() => {\n        // Open the mini cart.\n        setMiniCartIsOpen(true);\n    }, [setMiniCartIsOpen]);\n\n    const handleLinkClick = useCallback(() => {\n        // Send the user to the cart page.\n        history.push('/cart');\n    }, [history]);\n\n    return {\n        handleLinkClick,\n        handleTriggerClick,\n        itemCount,\n        miniCartIsOpen,\n        miniCartRef,\n        hideCartTrigger,\n        setMiniCartIsOpen\n    };\n};\n"]}