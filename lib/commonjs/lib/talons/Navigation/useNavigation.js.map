{"version":3,"sources":["useNavigation.js"],"names":["ancestors","CREATE_ACCOUNT","FORGOT_PASSWORD","MY_ACCOUNT","SIGN_IN","MENU","useNavigation","props","customerQuery","appState","closeDrawer","catalogState","actions","catalogActions","getUserDetails","fetchUserDetails","drawer","isOpen","categories","rootCategoryId","view","setView","categoryId","setCategoryId","category","isTopLevel","hasModal","handleBack","parent","parentId","handleClose","showCreateAccount","showForgotPassword","showMainMenu","showMyAccount","showSignIn"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport { useAppContext } from '@magento/peregrine/lib/context/app';\nimport { useCatalogContext } from '@magento/peregrine/lib/context/catalog';\nimport { useUserContext } from '@magento/peregrine/lib/context/user';\nimport { useAwaitQuery } from '@magento/peregrine/lib/hooks/useAwaitQuery';\n\nconst ancestors = {\n    CREATE_ACCOUNT: 'SIGN_IN',\n    FORGOT_PASSWORD: 'SIGN_IN',\n    MY_ACCOUNT: 'MENU',\n    SIGN_IN: 'MENU',\n    MENU: null\n};\n\nexport const useNavigation = props => {\n    const { customerQuery } = props;\n    // retrieve app state from context\n    const [appState, { closeDrawer }] = useAppContext();\n    const [catalogState, { actions: catalogActions }] = useCatalogContext();\n    const [, { getUserDetails }] = useUserContext();\n    const fetchUserDetails = useAwaitQuery(customerQuery);\n\n    // request data from server\n    useEffect(() => {\n        getUserDetails({ fetchUserDetails });\n    }, [fetchUserDetails, getUserDetails]);\n\n    // extract relevant data from app state\n    const { drawer } = appState;\n    const isOpen = drawer === 'nav';\n    const { categories, rootCategoryId } = catalogState;\n\n    // get local state\n    const [view, setView] = useState('MENU');\n    const [categoryId, setCategoryId] = useState(rootCategoryId);\n\n    // define local variables\n    const category = categories[categoryId];\n    const isTopLevel = categoryId === rootCategoryId;\n    const hasModal = view !== 'MENU';\n\n    // define handlers\n    const handleBack = useCallback(() => {\n        const parent = ancestors[view];\n\n        if (parent) {\n            setView(parent);\n        } else if (category && !isTopLevel) {\n            setCategoryId(category.parentId);\n        } else {\n            closeDrawer();\n        }\n    }, [category, closeDrawer, isTopLevel, view]);\n\n    const handleClose = useCallback(() => {\n        closeDrawer();\n    }, [closeDrawer]);\n\n    // create callbacks for local state\n    const showCreateAccount = useCallback(() => {\n        setView('CREATE_ACCOUNT');\n    }, [setView]);\n    const showForgotPassword = useCallback(() => {\n        setView('FORGOT_PASSWORD');\n    }, [setView]);\n    const showMainMenu = useCallback(() => {\n        setView('MENU');\n    }, [setView]);\n    const showMyAccount = useCallback(() => {\n        setView('MY_ACCOUNT');\n    }, [setView]);\n    const showSignIn = useCallback(() => {\n        setView('SIGN_IN');\n    }, [setView]);\n\n    return {\n        catalogActions,\n        categories,\n        categoryId,\n        handleBack,\n        handleClose,\n        hasModal,\n        isOpen,\n        isTopLevel,\n        setCategoryId,\n        showCreateAccount,\n        showForgotPassword,\n        showMainMenu,\n        showMyAccount,\n        showSignIn,\n        view\n    };\n};\n"]}