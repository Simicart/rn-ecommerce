{"version":3,"sources":["useProductImageCarousel.js"],"names":["useProductImageCarousel","props","images","type","imageWidth","carouselState","carouselApi","activeItemIndex","sortedImages","handlePrevious","handleNext","setActiveItemIndex","handleThumbnailClick","index","VALID_SERVICE_WORKER_ENVIRONMENT","urls","map","file","URL","location","origin","href","PREFETCH_IMAGES","catch","err","console","error","currentImage","altText","label"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AAIA;;AACA;;AAEO,MAAMA,uBAAuB,GAAGC,KAAK,IAAI;AAC5C,QAAM;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,IAAV;AAAgBC,IAAAA;AAAhB,MAA+BH,KAArC;AACA,QAAM,CAACI,aAAD,EAAgBC,WAAhB,IAA+B,4BAAYJ,MAAZ,CAArC;AACA,QAAM;AAAEK,IAAAA,eAAF;AAAmBC,IAAAA;AAAnB,MAAoCH,aAA1C;AACA,QAAM;AAAEI,IAAAA,cAAF;AAAkBC,IAAAA,UAAlB;AAA8BC,IAAAA;AAA9B,MAAqDL,WAA3D;AAEA,QAAMM,oBAAoB,GAAG,wBACzBC,KAAK,IAAI;AACLF,IAAAA,kBAAkB,CAACE,KAAD,CAAlB;AACH,GAHwB,EAIzB,CAACF,kBAAD,CAJyB,CAA7B,CAN4C,CAa5C;;AACA,wBAAU,MAAM;AACZA,IAAAA,kBAAkB,CAAC,CAAD,CAAlB;AACH,GAFD,EAEG,CAACT,MAAD,EAASS,kBAAT,CAFH;AAIA,wBAAU,MAAM;AACZ,QAAIG,yCAAJ,EAAsC;AAClC,YAAMC,IAAI,GAAGb,MAAM,CAACc,GAAP,CACT,CAAC;AAAEC,QAAAA;AAAF,OAAD,KACI,IAAIC,GAAJ,CACI,2CAA8BD,IAA9B,EAAoCb,UAApC,EAAgDD,IAAhD,CADJ,EAEIgB,QAAQ,CAACC,MAFb,EAGEC,IALG,CAAb;AAOA,oCAAgBC,+BAAhB,EAAiC;AAC7BP,QAAAA;AAD6B,OAAjC,EAEGQ,KAFH,CAESC,GAAG,IAAI;AACZC,QAAAA,OAAO,CAACC,KAAR,CACI,8CADJ,EAEIF,GAFJ;AAIH,OAPD;AAQH;AACJ,GAlBD,EAkBG,CAACtB,MAAD,EAASE,UAAT,EAAqBD,IAArB,CAlBH;AAoBA,QAAMwB,YAAY,GAAGnB,YAAY,CAACD,eAAD,CAAZ,IAAiC,EAAtD;AACA,QAAMqB,OAAO,GAAGD,YAAY,CAACE,KAAb,IAAsB,eAAtC;AAEA,SAAO;AACHF,IAAAA,YADG;AAEHpB,IAAAA,eAFG;AAGHqB,IAAAA,OAHG;AAIHlB,IAAAA,UAJG;AAKHD,IAAAA,cALG;AAMHG,IAAAA,oBANG;AAOHJ,IAAAA;AAPG,GAAP;AASH,CAlDM","sourcesContent":["import { useCallback, useEffect } from 'react';\n\nimport { useCarousel } from '@magento/peregrine';\n\nimport {\n    sendMessageToSW,\n    VALID_SERVICE_WORKER_ENVIRONMENT\n} from '@magento/venia-ui/lib/util/swUtils';\nimport { PREFETCH_IMAGES } from '@magento/venia-ui/lib/constants/swMessageTypes';\nimport { generateUrlFromContainerWidth } from '@magento/venia-ui/lib/util/images';\n\nexport const useProductImageCarousel = props => {\n    const { images, type, imageWidth } = props;\n    const [carouselState, carouselApi] = useCarousel(images);\n    const { activeItemIndex, sortedImages } = carouselState;\n    const { handlePrevious, handleNext, setActiveItemIndex } = carouselApi;\n\n    const handleThumbnailClick = useCallback(\n        index => {\n            setActiveItemIndex(index);\n        },\n        [setActiveItemIndex]\n    );\n\n    // Whenever the incoming images changes reset the active item to the first.\n    useEffect(() => {\n        setActiveItemIndex(0);\n    }, [images, setActiveItemIndex]);\n\n    useEffect(() => {\n        if (VALID_SERVICE_WORKER_ENVIRONMENT) {\n            const urls = images.map(\n                ({ file }) =>\n                    new URL(\n                        generateUrlFromContainerWidth(file, imageWidth, type),\n                        location.origin\n                    ).href\n            );\n            sendMessageToSW(PREFETCH_IMAGES, {\n                urls\n            }).catch(err => {\n                console.error(\n                    'Unable to send PREFETCH_IMAGES message to SW',\n                    err\n                );\n            });\n        }\n    }, [images, imageWidth, type]);\n\n    const currentImage = sortedImages[activeItemIndex] || {};\n    const altText = currentImage.label || 'image-product';\n\n    return {\n        currentImage,\n        activeItemIndex,\n        altText,\n        handleNext,\n        handlePrevious,\n        handleThumbnailClick,\n        sortedImages\n    };\n};\n"]}