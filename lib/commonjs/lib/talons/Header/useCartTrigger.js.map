{"version":3,"sources":["useCartTrigger.js"],"names":["DENIED_MINI_CART_ROUTES","useCartTrigger","props","queries","getItemCountQuery","cartId","elementRef","miniCartRef","expanded","miniCartIsOpen","setExpanded","setMiniCartIsOpen","history","data","fetchPolicy","nextFetchPolicy","variables","skip","itemCount","cart","total_quantity","hideCartTrigger","includes","location","pathname","handleTriggerClick","handleLinkClick","push"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEA;;AACA;;AAEA;;;AAGA,MAAMA,uBAAuB,GAAG,CAAC,WAAD,CAAhC;AAEA;;;;;;;;;;;;;;;AAcO,MAAMC,cAAc,GAAGC,KAAK,IAAI;AACnC,QAAM;AACFC,IAAAA,OAAO,EAAE;AAAEC,MAAAA;AAAF;AADP,MAEFF,KAFJ;AAIA,QAAM,CAAC;AAAEG,IAAAA;AAAF,GAAD,IAAe,2BAArB;AACA,QAAM;AACFC,IAAAA,UAAU,EAAEC,WADV;AAEFC,IAAAA,QAAQ,EAAEC,cAFR;AAGFC,IAAAA,WAAW,EAAEC;AAHX,MAIF,+BAJJ;AAKA,QAAMC,OAAO,GAAG,iCAAhB;AAEA,QAAM;AAAEC,IAAAA;AAAF,MAAW,sBAAST,iBAAT,EAA4B;AACzCU,IAAAA,WAAW,EAAE,mBAD4B;AAEzCC,IAAAA,eAAe,EAAE,aAFwB;AAGzCC,IAAAA,SAAS,EAAE;AACPX,MAAAA;AADO,KAH8B;AAMzCY,IAAAA,IAAI,EAAE,CAACZ;AANkC,GAA5B,CAAjB;AAQA,QAAMa,SAAS,GAAGL,IAAI,GAAGA,IAAI,CAACM,IAAL,CAAUC,cAAb,GAA8B,CAApD;AACA,QAAMC,eAAe,GAAGrB,uBAAuB,CAACsB,QAAxB,CACpBV,OAAO,CAACW,QAAR,CAAiBC,QADG,CAAxB;AAIA,QAAMC,kBAAkB,GAAG,wBAAY,MAAM;AACzC;AACAd,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACH,GAH0B,EAGxB,CAACA,iBAAD,CAHwB,CAA3B;AAKA,QAAMe,eAAe,GAAG,wBAAY,MAAM;AACtC;AACAd,IAAAA,OAAO,CAACe,IAAR,CAAa,OAAb;AACH,GAHuB,EAGrB,CAACf,OAAD,CAHqB,CAAxB;AAKA,SAAO;AACHc,IAAAA,eADG;AAEHD,IAAAA,kBAFG;AAGHP,IAAAA,SAHG;AAIHT,IAAAA,cAJG;AAKHF,IAAAA,WALG;AAMHc,IAAAA,eANG;AAOHV,IAAAA;AAPG,GAAP;AASH,CA7CM","sourcesContent":["import { useCallback } from 'react';\nimport { useQuery } from '@apollo/client';\nimport { useHistory } from 'react-router-dom';\n\nimport { useCartContext } from '@magento/peregrine/lib/context/cart';\nimport { useDropdown } from '@magento/peregrine/lib/hooks/useDropdown';\n\n/**\n * Routes to hide the mini cart on.\n */\nconst DENIED_MINI_CART_ROUTES = ['/checkout'];\n\n/**\n *\n * @param {DocumentNode} props.queries.getItemCountQuery query to get the total cart items count\n *\n * @returns {\n *      itemCount: Number,\n *      miniCartIsOpen: Boolean,\n *      handleLinkClick: Function,\n *      handleTriggerClick: Function,\n *      miniCartRef: Function,\n *      hideCartTrigger: Function,\n *      setMiniCartIsOpen: Function\n *  }\n */\nexport const useCartTrigger = props => {\n    const {\n        queries: { getItemCountQuery }\n    } = props;\n\n    const [{ cartId }] = useCartContext();\n    const {\n        elementRef: miniCartRef,\n        expanded: miniCartIsOpen,\n        setExpanded: setMiniCartIsOpen\n    } = useDropdown();\n    const history = useHistory();\n\n    const { data } = useQuery(getItemCountQuery, {\n        fetchPolicy: 'cache-and-network',\n        nextFetchPolicy: 'cache-first',\n        variables: {\n            cartId\n        },\n        skip: !cartId\n    });\n    const itemCount = data ? data.cart.total_quantity : 0;\n    const hideCartTrigger = DENIED_MINI_CART_ROUTES.includes(\n        history.location.pathname\n    );\n\n    const handleTriggerClick = useCallback(() => {\n        // Open the mini cart.\n        setMiniCartIsOpen(true);\n    }, [setMiniCartIsOpen]);\n\n    const handleLinkClick = useCallback(() => {\n        // Send the user to the cart page.\n        history.push('/cart');\n    }, [history]);\n\n    return {\n        handleLinkClick,\n        handleTriggerClick,\n        itemCount,\n        miniCartIsOpen,\n        miniCartRef,\n        hideCartTrigger,\n        setMiniCartIsOpen\n    };\n};\n"]}